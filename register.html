<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#667eea">
    <title>Daftar - SCANS</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body class="auth-page">

<div class="auth-container">
    <div class="auth-box">
        <!-- Logo & Title -->
        <div class="auth-header">
            <div class="auth-logo">
                <i class="fas fa-user-plus"></i>
            </div>
            <h1>Daftar Akun Baru</h1>
            <p>Mulai berbelanja sekarang!</p>
        </div>

        <!-- Register Form -->
        <form id="registerForm" class="auth-form">
            <div class="form-group">
                <label for="full_name">
                    <i class="fas fa-id-card"></i>
                    Nama Lengkap
                </label>
                <input 
                    type="text" 
                    id="full_name" 
                    name="full_name" 
                    placeholder="Masukkan nama lengkap"
                    required
                    autocomplete="name"
                >
            </div>

            <div class="form-group">
                <label for="username">
                    <i class="fas fa-user"></i>
                    Username
                </label>
                <input 
                    type="text" 
                    id="username" 
                    name="username" 
                    placeholder="Pilih username (min. 4 karakter)"
                    required
                    minlength="4"
                    autocomplete="username"
                >
                <small class="form-hint">Hanya huruf, angka, dan underscore</small>
            </div>

            <div class="form-group">
                <label for="email">
                    <i class="fas fa-envelope"></i>
                    Email
                </label>
                <input 
                    type="email" 
                    id="email" 
                    name="email" 
                    placeholder="nama@email.com"
                    required
                    autocomplete="email"
                >
            </div>

            <div class="form-group">
                <label for="phone">
                    <i class="fas fa-phone"></i>
                    No. HP (Opsional)
                </label>
                <input 
                    type="tel" 
                    id="phone" 
                    name="phone" 
                    placeholder="08xxxxxxxxxx"
                    autocomplete="tel"
                >
            </div>

            <div class="form-group">
                <label for="password">
                    <i class="fas fa-lock"></i>
                    Password
                </label>
                <div class="password-input-wrapper">
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        placeholder="Minimal 6 karakter"
                        required
                        minlength="6"
                        autocomplete="new-password"
                    >
                    <button type="button" class="toggle-password" onclick="togglePassword('password')">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <div class="password-strength" id="passwordStrength"></div>
            </div>

            <div class="form-group">
                <label for="password_confirm">
                    <i class="fas fa-lock"></i>
                    Konfirmasi Password
                </label>
                <div class="password-input-wrapper">
                    <input 
                        type="password" 
                        id="password_confirm" 
                        name="password_confirm" 
                        placeholder="Ketik ulang password"
                        required
                        autocomplete="new-password"
                    >
                    <button type="button" class="toggle-password" onclick="togglePassword('password_confirm')">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
            </div>

            <div class="form-options">
                <label class="checkbox-label">
                    <input type="checkbox" id="terms" name="terms" required>
                    <span>Saya setuju dengan <a href="#" target="_blank">Syarat & Ketentuan</a></span>
                </label>
            </div>

            <button type="submit" class="btn-auth btn-primary">
                <i class="fas fa-user-plus"></i>
                <span>Daftar Sekarang</span>
            </button>
        </form>

        <!-- Login Link -->
        <div class="auth-footer">
            <p>Sudah punya akun? <a href="login.html">Masuk di sini</a></p>
        </div>

        <!-- Back to Home -->
        <div class="auth-back">
            <a href="home.html">
                <i class="fas fa-arrow-left"></i> Kembali ke beranda
            </a>
        </div>
    </div>
</div>

<!-- Alert Container -->
<div id="alertContainer"></div>

<script src="js/auth.js"></script>
<script>
    // Password strength checker
    document.getElementById('password').addEventListener('input', (e) => {
        const password = e.target.value;
        const strengthBar = document.getElementById('passwordStrength');
        
        if (!password) {
            strengthBar.innerHTML = '';
            return;
        }
        
        let strength = 0;
        let text = '';
        let color = '';
        
        // Check length
        if (password.length >= 6) strength++;
        if (password.length >= 8) strength++;
        
        // Check for numbers
        if (/\d/.test(password)) strength++;
        
        // Check for uppercase and lowercase
        if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength++;
        
        // Check for special characters
        if (/[!@#$%^&*(),.?":{}|<>]/.test(password)) strength++;
        
        if (strength <= 2) {
            text = 'Lemah';
            color = '#f44336';
        } else if (strength <= 3) {
            text = 'Sedang';
            color = '#ff9800';
        } else if (strength <= 4) {
            text = 'Kuat';
            color = '#4CAF50';
        } else {
            text = 'Sangat Kuat';
            color = '#2196F3';
        }
        
        strengthBar.innerHTML = `
            <div class="strength-bar" style="background: ${color}; width: ${strength * 20}%"></div>
            <div class="strength-text" style="color: ${color}">${text}</div>
        `;
    });

    // Initialize register form
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const formData = {
            full_name: document.getElementById('full_name').value,
            username: document.getElementById('username').value,
            email: document.getElementById('email').value,
            phone: document.getElementById('phone').value,
            password: document.getElementById('password').value,
            password_confirm: document.getElementById('password_confirm').value
        };
        
        // Validate passwords match
        if (formData.password !== formData.password_confirm) {
            showAlert('error', 'Password tidak cocok!');
            return;
        }
        
        // Validate username format
        if (!/^[a-zA-Z0-9_]+$/.test(formData.username)) {
            showAlert('error', 'Username hanya boleh berisi huruf, angka, dan underscore');
            return;
        }
        
        await handleRegister(formData);
    });

    // Toggle password visibility
    function togglePassword(fieldId) {
        const field = document.getElementById(fieldId);
        const button = field.nextElementSibling;
        const icon = button.querySelector('i');
        
        if (field.type === 'password') {
            field.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            field.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    }
</script>

</body>
</html>

